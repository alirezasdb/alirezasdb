name: Generate Snake

# زمان‌بندی اجرای workflow و امکان اجرا دستی
on:
  schedule:
    - cron: "0 0 * * *"  # هر روز نیمه شب
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # 1️⃣ دریافت آخرین نسخه branch main
      - name: Checkout main
        uses: actions/checkout@v3
        with:
          ref: main

      # 2️⃣ ساخت پوشه dist (در صورت عدم وجود)
      - name: Make dist folder
        run: mkdir -p dist

      # 3️⃣ تولید مار GitHub
      - name: Generate Snake Animation
        uses: Platane/snk@v3
        with:
          github_user_name: alirezasdb
          output: dist/github-contribution-grid-snake.svg

      # 4️⃣ Push SVG مار به branch output
      - name: Push to output branch
        uses: crazy-max/ghaction-github-pages@v3
        with:
          target_branch: output   # branch خروجی که SVG در آن ذخیره می‌شود
          build_dir: dist         # پوشه‌ای که فایل SVG در آن ساخته شده
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
